scale_y_continuous(breaks = breaks_pretty(6))+
scale_x_continuous(breaks = c(2014:2023))+
transition_reveal(season)+
shadow_mark(colour = "#D55E00", size = 4, exclude_layer = 1)+
ease_aes()
a3 <- animate(anim3, fps = 35, duration = 15,width = 500, height = 500, end_pause = 10)
anim_save('output/pop3.gif', animation = a3)
anim3 <-
ggplot(rolling_population)+
geom_line(aes(x=season, y =n), size = 1.5, colour = "#0072B2") +
geom_point(aes(x=season, y =n), color = "#D55E00", size = 4)+
labs(title = 'AFL population 2014-2023',
x = "Season",
y = "Population")+
theme_classic()+
theme(legend.position="bottom",
axis.text = element_text(size = 11,
colour = "black"),
plot.title  = element_text(size = 14, face = "bold"),
title = element_text(size = 12))+
scale_y_continuous(breaks = breaks_pretty(6))+
scale_x_continuous(breaks = c(2014:2023))+
transition_reveal(season)+
shadow_mark(colour = "#D55E00", size = 4, exclude_layer = 1)+
ease_aes()
a3 <- animate(anim3, fps = 35, duration = 15,width = 500, height = 500, end_pause = 10)
anim_save('output/pop3.gif', animation = a3)
image_write(new_gif,path = "pop4.gif", format = 'gif')
population %>%
arrange(season)%>%
group_by(season,team)%>%
add_count(id)
population %>%
filter(seson == 2023)
population %>%
filter(seson == 2023) %>%
arrange(season)%>%
group_by(season,team)%>%
add_count(id)
population %>%
filter(season == 2023) %>%
arrange(season)%>%
group_by(season,team)%>%
add_count(id)
population %>%
filter(season == 2023) %>%
arrange(season)%>%
group_by(season,team)%>%
add_count(id) %>%
select(team,n)
population %>%
filter(season == 2023) %>%
arrange(season)%>%
group_by(season,team)%>%
add_count(id) %>%
summarise(n = sum(n))%>%
select(team,n)
club_pops <-
population %>%
filter(season == 2023) %>%
arrange(season)%>%
group_by(season,team)%>%
add_count(id) %>%
summarise(n = sum(n))%>%
select(team,n)
View(club_pops)
ggplot(club_pops)+
geom_col(aes(x=n,y=team))
ggplot(club_pops)+
geom_col(aes(x=n,y=team))+
scale_x_continuous(limits = c(40,50))
ggplot(club_pops)+
geom_col(aes(x=n,y=team))+
scale_x_continuous(limits = c(40,50))
ggplot(club_pops)+
geom_col(aes(x=n,y=team))+
scale_x_continuous(limits = c(30,50))
ggplot(club_pops)+
geom_col(aes(x=n,y=team))
ggplot(club_pops)+
geom_col(aes(x=n,y=team, fill = team))+
ggplot(club_pops)+
geom_col(aes(x=n,y=team, fill = team))+
scale_fill_manual(values = team_colours)
# Team colours from @crow_data_sci
team_colours <- c(
'Carlton'= '#0e1e2d',
'Geelong Cats'= '#1c3c63',
'Adelaide Crows'= '#002b5c',
'Sydney Swans' = '#ed171f',
'St Kilda' = '#ed0f05',
'Essendon' = '#cc2031',
'Richmond'= '#D8D800',
'Melbourne'= '#0f1131',
'Hawthorn' = '#4d2004',
'Brisbane Lions' = '#a30046',
'Gold Coast Suns' = '#d93e39',
'Fremantle'= '#2a1a54',
'Collingwood'= '#000000',
'Port Adelaide'  = '#01b5b6',
'Western Bulldogs'  = '#014896',
'West Coast Eagles' = '#062ee2',
'North Melbourne'= '#013b9f',
'GWS Giants' = '#f15c22')
ggplot(club_pops)+
geom_col(aes(x=n,y=team, fill = team))+
scale_fill_manual(values = team_colours)
club_pops %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot()+
geom_col(aes(x=n,y=team, fill = team))+
scale_fill_manual(values = team_colours)
club_pops %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = scales::comma(insta_followers)), colour = "white")+
guides(fill = "none")+
theme(plot.margin = margin(0.5,1,0.5,0.5, "cm"))
club_pops %>%
%>%
mutate(label_y = n *0.5)
geom_text(aes(x = label_y, colour = "white")+
)+
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, colour = "white"))+
guides(fill = "none")+
theme(plot.margin = margin(0.5,1,0.5,0.5, "cm"))
club_pops
club_pops %>%
%>%
mutate(label_y = n *0.5) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, colour = "white"))+
guides(fill = "none")+
theme(plot.margin = margin(0.5,1,0.5,0.5, "cm"))
club_pops
club_pops %>%
%>%
mutate(label_y = (n * 0.5)) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, colour = "white"))+
guides(fill = "none")+
theme(plot.margin = margin(0.5,1,0.5,0.5, "cm"))
club_pops %>%
%>%
mutate(label_y = (as.numeric(n) * 0.5)) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, colour = "white"))+
guides(fill = "none")+
theme(plot.margin = margin(0.5,1,0.5,0.5, "cm"))
club_pops %>%
%>%
mutate(label_y = n+1) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, colour = "white"))+
guides(fill = "none")+
theme(plot.margin = margin(0.5,1,0.5,0.5, "cm"))
club_pops %>%
%>%
mutate(label_y = n) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, colour = "white"))+
guides(fill = "none")+
theme(plot.margin = margin(0.5,1,0.5,0.5, "cm"))
club_pops %>%
mutate(label_y = n) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, colour = "white"))+
guides(fill = "none")+
theme(plot.margin = margin(0.5,1,0.5,0.5, "cm"))
club_pops %>%
mutate(label_y = n) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = label_y colour = "white"))+
guides(fill = "none")+
theme(plot.margin = margin(0.5,1,0.5,0.5, "cm"))
club_pops %>%
mutate(label_y = n) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = label_y, colour = "white"))+
guides(fill = "none")+
theme(plot.margin = margin(0.5,1,0.5,0.5, "cm"))
club_pops %>%
mutate(label_y = n * 0.5) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = label_y, colour = "white"))+
guides(fill = "none")+
theme(plot.margin = margin(0.5,1,0.5,0.5, "cm"))
club_pops %>%
mutate(label_y = n * 0.5) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = label_y),colour = "white")+
guides(fill = "none")+
theme(plot.margin = margin(0.5,1,0.5,0.5, "cm"))
club_pops %>%
mutate(label_y = n * 0.5) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = n),colour = "white")+
guides(fill = "none")+
theme(plot.margin = margin(0.5,1,0.5,0.5, "cm"))
club_pops %>%
mutate(label_y = n * 0.5) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = n),colour = "white")+
guides(fill = "none")
club_pops %>%
mutate(label_y = n * 0.5) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = n),colour = "white")+
guides(fill = "none")
club_pops %>%
mutate(label_y = n * 0.5) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0),
limits = 0,50)+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = n),colour = "white")+
guides(fill = "none")
club_pops %>%
mutate(label_y = n * 0.5) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0),
limits = c(0,50))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = n),colour = "white")+
guides(fill = "none")
club_pops %>%
mutate(label_y = n * 0.5) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0),
limits = c(0,50))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = n),colour = "white", face = "bold")+
guides(fill = "none")
club_pops %>%
mutate(label_y = n * 0.5) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0),
limits = c(0,50))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = n),colour = "white", fontface = "bold")+
guides(fill = "none")
club_pops %>%
mutate(label_y = n -2) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0),
limits = c(0,50))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = n),colour = "white", fontface = "bold")+
guides(fill = "none")
club_pops %>%
mutate(label_y = n - 1) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0),
limits = c(0,50))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (Population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = n),colour = "white", fontface = "bold")+
guides(fill = "none")
club_pops %>%
mutate(label_y = n - 1) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0),
limits = c(0,50))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = n),colour = "white", fontface = "bold")+
guides(fill = "none")
club_pops %>%
mutate(label_y = n - 1) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0),
limits = c(0,50))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = n),colour = "white", fontface = "bold")+
guides(fill = "none")+
theme_classic()
club_pops %>%
mutate(label_y = n - 1) %>%
mutate(team = fct_reorder(team, n)) %>%
ggplot(aes(y=team,x=n,fill=team))+
scale_fill_manual(values=team_colours)+
geom_col()+
scale_x_continuous(expand = c(0,0),
limits = c(0,50))+
labs(
x="List size",
y="Club",
title = "AFL teams list sizes (population)",
subtitle = "2023"
)+
geom_text(aes(x = label_y, label = n),colour = "white", fontface = "bold")+
guides(fill = "none")+
theme_classic()+
theme(legend.position="bottom",
axis.text = element_text(size = 11,
colour = "black"),
plot.title  = element_text(size = 14, face = "bold"),
title = element_text(size = 12))
rolling_population
a3 <- animate(anim3, fps = 35, duration = 15,width = 500, height = 500, end_pause = 15)
anim_save('output/pop3.gif', animation = a3)
